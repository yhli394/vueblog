---
toc: true
title: 01：一条SQL查询语句是如何执行的？
date: 2022-3-9
tags: [MySQL实战45讲]
categories:
 - MySQL
---

![一条SQL查询语句是如何执行的？-2022-05-08-20-43-51](https://images-1309978559.cos.ap-chengdu.myqcloud.com/blogimages/一条SQL查询语句是如何执行的？-2022-05-08-20-43-51.png)

上图展示了一条SQL语句的执行过程。MySQL大致可以分为Server层和存储引擎层。其中，Server层主要包括连接器、查询缓存、分析器、执行器、优化器。而存储引擎层有InnoDB、MyISAM、Memory等存储引擎。

​SQL语句（以查询语句为例）执行过程中所经过的”组件“的作用如下：

- 连接器：负责和客户端建立连接、获取权限、维持和管理连接。
- 查询缓存：MySQL会先去缓存中查找该SQL语句是否有缓存，如果命中缓存，那么直接返回；如果没有缓存，那么继续往后面执行。
- 分析器：包括词法分析（判断sql语句是crud中的哪一种）和语法分析（判断sql语句的语法是否符合规范）。
- 优化器：表中有多个索引的时候，决定使用哪一个索引效率高或者在一个语句中有多表关联(join)的时候，决定各个表的连接顺序，以使得SQL语句执行效率最高。
- 执行器：执行SQL语句。

Notes:

1. 一般不建议使用查询缓存，因为查询缓存失效很快，只要有对一个表的更新，那么这个表上所有的缓存都会被清空。MySQL8.0版本直接将查询缓存的整块功能删除掉了。
