---
toc: true
title: 22-MySQL有哪些“饮鸠止渴”提高性能的方法？
date: 2022-6-27
tags: [MySQL实战45讲]
categories:
 - MySQL
---

本篇博客讨论的业务场景如下：在生产环境中，由于并发量剧增导致MySQL压力过大，响应变慢，需要一些临时提升性能的方案。

## 方案一：使用短连接

> 正常的短连接模式(max_connections，用来控制一个 MySQL 实例同时存在的连接数的上限，超过这个值，系统就会拒绝接下来的连接请求，并报错提示“Too many connections”。)就是连接到数据库后，执行很少的 SQL 语句就断开，下次需要的时候再重连。如果使用的是短连接，在业务高峰期的时候，就可能出现连接数突然暴涨的情况(MySQL 建立连接的过程，成本是很高的。除了正常的网络连接三次握手外，还需要做登录权限判断和获得这个连接的数据读写权限)。短连接模型存在一个风险，就是一旦数据库处理得慢一些，连接数就会暴涨。如果max_connections参数设置的太大，让更多的连接都可以进来，那么系统的负载可能会进一步加大，大量的资源耗费在权限验证等逻辑上，结果可能是适得其反，已经连接的线程拿不到 CPU 资源去执行业务的 SQL 请求。针对这种情况，可以尝试如下两种方法：①先处理掉那些占着连接但是不工作的线程（提示：可以结合show processlist命令进行排查）。②减少连接过程的消耗（例如跳过数据库权限验证阶段等）。

## 方案二：对慢查询进行排查并优化

MySQL中引起慢查询的因素有很多，主要有以下因素：

- 索引没有设计好

- SQL语句不是最优的

- MySQL选错了索引
